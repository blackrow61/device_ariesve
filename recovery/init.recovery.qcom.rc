on init
    export LD_LIBRARY_PATH .:/sbin /system/lib

    # legacy symlink
    rmdir /external_sd
    symlink /storage/sdcard1 /external_sd

# Required to fix shutdown issue
service rmt_storage /sbin/rmt_storage

# Required for usb mass storage
on property:ro.debuggable=1
    setprop sys.usb.config mass_storage,adb

on property:sys.usb.config=mass_storage,adb
    write /sys/class/android_usb/android0/enable 0
    write /sys/class/android_usb/android0/idVendor 04e8
    write /sys/class/android_usb/android0/idProduct 685e
    write /sys/class/android_usb/android0/functions ${sys.usb.config}
    write /sys/class/android_usb/android0/enable 1
    start adbd
    setprop sys.usb.state ${sys.usb.config}
